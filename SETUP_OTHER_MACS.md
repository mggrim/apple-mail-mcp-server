# Setting Up Apple Mail MCP Server on Additional Macs

## Quick Context

This is an MCP (Model Context Protocol) server that gives Claude Desktop and Claude Code the ability to interact with Apple Mail. It was built on your first Mac and is now in a GitHub repository.

## What This Server Does

Provides Claude with 9 tools to:
- Search and read emails
- List mailboxes and accounts  
- Create drafts and send emails
- Move emails and mark as read/unread
- View attachments

## Installation on New Mac

### Step 1: Clone the Repository

```bash
# Clone to the same location for consistency across machines
cd ~/Documents
git clone https://github.com/mggrim/apple-mail-mcp-server.git
cd apple-mail-mcp-server
```

### Step 2: Run the Automated Installer

```bash
# This will install dependencies, build, and configure both Claude Desktop and Claude Code
chmod +x install.sh
./install.sh --claude-desktop --claude-code
```

The installer will:
- Run `npm install` to install dependencies
- Run `npm run build` to compile TypeScript to JavaScript
- Update `~/Library/Application Support/Claude/claude_desktop_config.json` for Claude Desktop
- Update `~/.config/claude/config.json` for Claude Code

### Step 3: Restart Claude Desktop

Quit and reopen Claude Desktop for the changes to take effect.

## Manual Installation (If Installer Fails)

### Install and Build

```bash
cd ~/Documents/apple-mail-mcp-server
npm install
npm run build
```

### Configure Claude Desktop

Edit `~/Library/Application Support/Claude/claude_desktop_config.json`:

```json
{
  "mcpServers": {
    "apple-mail": {
      "command": "node",
      "args": ["/Users/YOUR_USERNAME/Documents/apple-mail-mcp-server/dist/index.js"],
      "env": {
        "TRANSPORT": "stdio"
      }
    }
  }
}
```

**Important:** Replace `YOUR_USERNAME` with your actual username, or use the full path.

### Configure Claude Code

Edit or create `~/.config/claude/config.json`:

```json
{
  "mcpServers": {
    "apple-mail": {
      "command": "node",
      "args": ["/Users/YOUR_USERNAME/Documents/apple-mail-mcp-server/dist/index.js"],
      "env": {
        "TRANSPORT": "stdio"
      }
    }
  }
}
```

## Verification

### For Claude Desktop:
1. Open Claude Desktop
2. Start a new conversation
3. You should see the Apple Mail tools available
4. Try asking: "Search my emails for receipts from the last week"

### For Claude Code:
1. Run `claude` in your terminal
2. The Apple Mail server should connect automatically
3. Try asking: "List my email accounts"

## Troubleshooting

### Connection Error

If you get "Could not connect to MCP server":

1. Check the server builds correctly:
   ```bash
   cd ~/Documents/apple-mail-mcp-server
   npm run build
   ```

2. Verify the path in your config matches where you cloned the repo

3. Test the server manually:
   ```bash
   TRANSPORT=stdio node ~/Documents/apple-mail-mcp-server/dist/index.js
   ```
   
   Press Ctrl+C to exit. If you see errors, the build may have failed.

### Path Issues

If you clone to a different location, update the `args` path in both config files.

### Permission Issues

Make sure Apple Mail is installed and you've given it necessary permissions.

## Keeping in Sync Across Macs

### When you make changes on any Mac:

```bash
cd ~/Documents/apple-mail-mcp-server
git add .
git commit -m "Description of changes"
git push
```

### On other Macs, pull the changes:

```bash
cd ~/Documents/apple-mail-mcp-server
git pull
npm run build
```

No need to restart Claude - changes take effect on next MCP server connection.

## Project Structure

```
apple-mail-mcp-server/
├── src/               # TypeScript source code
│   ├── index.ts       # Main entry point
│   ├── types.ts       # Type definitions
│   ├── services/      # AppleScript execution
│   ├── schemas/       # Zod validation schemas
│   └── tools/         # MCP tool implementations
├── dist/              # Compiled JavaScript (generated by build)
├── package.json       # Dependencies and scripts
├── tsconfig.json      # TypeScript configuration
└── install.sh         # Automated installer script
```

## Available Tools

Once connected, Claude can use these tools:

1. **apple_mail_search** - Search emails by query, sender, subject, mailbox
2. **apple_mail_get_email** - Get full email details by ID
3. **apple_mail_list_mailboxes** - List all mailboxes/folders
4. **apple_mail_get_attachments** - List attachments for an email
5. **apple_mail_move_email** - Move email to different folder
6. **apple_mail_mark_read** - Mark email as read/unread
7. **apple_mail_create_draft** - Create a draft email
8. **apple_mail_send_email** - Send email immediately
9. **apple_mail_list_accounts** - List all email accounts

## Technical Details

- **Language:** TypeScript compiled to JavaScript
- **Runtime:** Node.js (requires v18+)
- **Transport:** stdio (standard input/output)
- **MCP SDK:** @modelcontextprotocol/sdk v1.x
- **Platform:** macOS only (requires Apple Mail)

## Support

- Repository: https://github.com/mggrim/apple-mail-mcp-server
- Issues: https://github.com/mggrim/apple-mail-mcp-server/issues

## Additional Notes

- The server communicates with Apple Mail via AppleScript
- All email operations are local - nothing is sent to external servers
- The server starts automatically when Claude connects
- Logs are written to stderr (visible in Claude Desktop's logs)
